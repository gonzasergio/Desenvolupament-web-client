<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <title>Act1b</title>
</head>
<body>
<div>
    <svg width="1200" height="850" id="meuDibuix">
        <rect width="800" height="450" style="fill:white; stroke:black"/>
        <g id="diagram"></g>
    </svg>
</div>
<script>

    var personas = [
        {
            "name":"Sergio",
            "cm": "182"
        },
        {
            "name":"Josete",
            "cm": "162"
        },
        {
            "name":"Jasito",
            "cm": "175"
        },
        {
            "name":"JB",
            "cm": "196"
        },
        {
            "name":"MJ",
            "cm": "170"
        },
        {
            "name":"Peri",
            "cm": "180"
        }
    ];

    var svg = document.getElementById('diagram');

    function createRect(x, y, w, h){

        var rect = document.createElementNS("http://www.w3.org/2000/svg","rect");

        rect.setAttributeNS(null, 'x', x);
        rect.setAttributeNS(null, 'y', y);
        rect.setAttributeNS(null, 'rx', '15');
        rect.setAttributeNS(null, 'ry', '15');
        rect.setAttributeNS(null, 'width', w -5);
        rect.setAttributeNS(null, 'height', h);

        var color = (h >= 180) ? 'red' : 'blue';

        rect.setAttributeNS(null, 'fill', color);
        rect.setAttributeNS(null, 'stroke-width', 1.5);
        rect.setAttribute("class", "fillOp");

        return rect;
    }

    function createText(x, y, tamany, font, txt){

        var text = document.createElementNS("http://www.w3.org/2000/svg","text");

        text.setAttributeNS(null, 'x', x);
        text.setAttributeNS(null, 'y', y);
        text.setAttributeNS(null,"font-size",tamany);
        text.setAttributeNS(null,"font-family",font);

        var textNode = document.createTextNode(txt);
        text.appendChild(textNode);

        return text;
    }

    function createBarDiagram(w){

        for(var i in personas){

            // Rectangles
            var rect = createRect(100 + i*w, 100, w, personas[i].cm);
            svg.appendChild(rect);

            // Text name
            var textName = createText(100 + i*w +10, 70, 24, "Arial, Helvetica, sans-serif", personas[i].name);
            svg.appendChild(textName);

            // Text cm
            var textCm = createText(100 + i*w + 22, 100 + parseInt(personas[i].cm) + 30, 18, "monospace", personas[i].cm+ "cm");
            svg.appendChild(textCm);

        }
    }

    $(document).ready(function(){
        createBarDiagram(100);
    });

</script>
</body>
</html>